%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                                %------------- Fulcrum -------------%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% This package is made by Yuntian Liu from SJTU AI4Math Team. 
% The original intention is to provide support for knowledge-block style mathematical notes. Later it's extended to support Lean 4 code writing. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                                %------------- Color Blocks -------------%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Custom Colors â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
\usepackage{xcolor}

\definecolor{green1}{RGB}{0, 156, 39}       % Dark Green
\definecolor{green2}{RGB}{214, 254, 224}    % Light Green

\definecolor{blue1}{RGB}{0, 91, 156}        % Dark Blue
\definecolor{blue2}{RGB}{218, 240, 255}     % Light Blue

\definecolor{pink1}{RGB}{172, 0, 175}       % Dark Pink
\definecolor{pink2}{RGB}{255, 237, 255}     % Light Pink

\definecolor{orange1}{RGB}{225, 124, 0}     % Dark Orange
\definecolor{orange2}{RGB}{255, 235, 210}   % Light Orange

\definecolor{purple1}{RGB}{119, 0, 229}     % Dark Purple
\definecolor{purple2}{RGB}{239, 223, 255}   % Light Purple

\definecolor{red1}{RGB}{211, 0, 35}        % Dark Red
\definecolor{red2}{RGB}{255, 214, 220}     % Light Red

\definecolor{grey1}{RGB}{120, 120, 120}     % Dark Grey
\definecolor{grey2}{RGB}{233, 233, 233}     % Light Grey

\definecolor{yellow1}{RGB}{192, 192, 0}     % Dark Yellow
\definecolor{yellow2}{RGB}{255, 255, 172}   % Light Yellow

% â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Custom Colors â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

% â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Box Settings â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

\usepackage{tcolorbox}
\tcbuselibrary{most}

\newenvironment{entry}[2]
    {
    \begin{tcolorbox}[enhanced, colback=#2, boxrule=0pt, frame hidden,
        borderline west={0.7mm}{0.1mm}{#1},breakable]
    }
    {\end{tcolorbox}}


% â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Settings â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

% â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Theorem Style â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
% Theorem support
\usepackage{amsthm}

% Reference support
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=cyan
} 

% Better command / environment support
\usepackage{xparse}

\newtheoremstyle{MyStyle}{0pt}{}{}{\parindent}{\bfseries}{}{1em}{}

\theoremstyle{MyStyle}

% #1 (Optional) UUID of the Entry
% #2 The Chinese Title of the Entry
% #3 The English Title of the Entry
% #4 Contributor to the entry

\newtheorem{axiom}{å…¬ç†}[section]
\NewDocumentEnvironment{axm}{omoo}
{
    \begin{entry}{yellow1}{yellow2}
        \begin{axiom}
            \textbf{#2\label{axm:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{axiom}
    \end{entry}
}

\newtheorem{rulethm}{è§„åˆ™}[section]
\NewDocumentEnvironment{rule}{omoo}
{
    \begin{entry}{yellow1}{yellow2}
        \begin{rulethm}
            \textbf{#2\label{rule:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{rulethm}
    \end{entry}
}

\newtheorem{definition}{å®šä¹‰}[subsection]
\NewDocumentEnvironment{dfn}{omoo}
{
    \begin{entry}{green1}{green2}
        \begin{definition}
            \textbf{#2\label{dfn:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{definition}
    \end{entry}
}


\newtheorem{structure}{ç»“æ„}[subsection]
\NewDocumentEnvironment{str}{omoo}
{
    \begin{entry}{green1}{green2}
        \begin{structure}
            \textbf{#2\label{str:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{structure}
    \end{entry}
}

\newtheorem{property}{æ€§è´¨}[definition]
\NewDocumentEnvironment{ppt}{omoo}
{
    \begin{entry}{pink1}{pink2}
        \begin{property}
            \textbf{#2\label{ppt:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{property}
    \end{entry}
}

\newtheorem{lemma}[definition]{å¼•ç†}
\NewDocumentEnvironment{lma}{omoo}
{
    \begin{entry}{blue1}{blue2}
        \begin{lemma}
            \textbf{#2\label{lma:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{lemma}
    \end{entry}
}

\newtheorem{theorem}[definition]{å®šç†}
\NewDocumentEnvironment{thm}{omoo}
{
    \begin{entry}{blue1}{blue2}
        \begin{theorem}
            \textbf{#2\label{thm:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{theorem}
    \end{entry}
}

\newtheorem{corollary}{æ¨è®º}[definition]
\NewDocumentEnvironment{crl}{omoo}
{
    \begin{entry}{purple1}{purple2}
        \begin{corollary}
            \textbf{#2\label{crl:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{corollary}
    \end{entry}
}

\newtheorem*{myproof}{è¯æ˜: \newline}
\newenvironment{prf}
{
    \begin{entry}{grey1}{grey2}
        \begin{myproof}
}
{
        \end{myproof}
    \end{entry}
}

\newtheorem{example}[definition]{ ä¾‹\, }
\NewDocumentEnvironment{xmp}{omoo}
{
    \begin{entry}{purple1}{purple2}
        \begin{example}
            \textbf{#2\label{xmp:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{example}
    \end{entry}
}

\newtheorem{cexample}[definition]{åä¾‹}
\NewDocumentEnvironment{cxmp}{omoo}
{
    \begin{entry}{red1}{red2}
        \begin{cexample}
            \textbf{#2\label{cxmp:#1}\IfNoValueTF{#3}{}{\IfBlankTF{#3}{}{ (#3)}}}
            \newline
}
{
        \end{cexample}
    \end{entry}
}

\newtheorem{remark}{ æ³¨\, }[definition]
\NewDocumentEnvironment{rmk}{o}
{
    \begin{entry}{orange1}{orange2}
        \begin{remark}
}
{
        \end{remark}
    \end{entry}
}

\newtheorem{problem}{é¢˜ç›®}
\NewDocumentEnvironment{pbm}{o}
{
    \begin{entry}{blue1}{blue2}
        \IfNoValueTF{#1}{}{\setcounter{problem}{#1}\addtocounter{problem}{-1}}
        \begin{problem}
}
{
        \end{problem}
    \end{entry}
}

\newtheorem*{solution}{è§£ç­”: \newline}
\newenvironment{slt}
{
    \begin{entry}{grey1}{grey2}
        \begin{solution}
}
{
        \end{solution}
    \end{entry}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                                %------------- Lean Code -------------%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{listings}
\newcommand{\smallsec}[1]{\paragraph{#1.}}
\lstset{
    basicstyle = \ttfamily,
}

% Define Colors: 
\definecolor{leanblue}{RGB}{0,0,255}
\colorlet{keyword}{leanblue}
\colorlet{punct}{leanblue}

\definecolor{sorry}{RGB}{255,0,0}
\definecolor{comment}{RGB}{0,128,0}
\definecolor{string}{RGB}{163,21,21}
\definecolor{num}{RGB}{9,134,88}

\definecolor{thname}{RGB}{121,94,38}

\definecolor{background}{HTML}{EEEEEE}
\definecolor{delim}{RGB}{20,105,176}

\newcommand*{\lean}[1]{\texttt{\color{blue}#1}}

\lstdefinelanguage{lean}{
    % Define Keywords: 
    alsoletter = {\#,\?,.},
    keywords = {
        import, 
        namespace, 
        end, 
        open, 
        variable, 
        Prop, 
        Type, 
        % Declarations: 
        protected, 
        class, 
        instance, 
        def, 
        axiom, 
        example, 
        theorem, 
        lemma, 
        fun, 
        by, 
        % Basics: 
        \#check, 
        \#leansearch, 
        \#eval, 
        % Tactics: 
        exact, 
            % FOL: 
            intro,
            intros, 
            rintro, 
            apply,
            refine, 
            apply?, 
            constructor, 
            rcases, 
            obtain, 
            use, 
            left, 
            right, 
            cases, 
            case, 
            by\_cases, 
            by\_contra, 
            contrapose, 
            contrapose!,
            % Others: 
            symm, 
            calc, 
            unfold, 
            have, 
            let, 
            rw, 
            at, 
            change, 
            show, 
        }, 
    keywords = [2]{sorry}, 
    %
    numbers=left,
    numberstyle=\color{num},
    %
    % morecomment = [l]{--},
    moredelim=[l][\color{comment}]{--}, % morecomment -> moredelim, so that Unicode characters can be used in comments. 
    moredelim=[is][\color{thname}]{\#tm\{}{\}}, 
    morecomment = [s]{/-}{-/},
    commentstyle = \color{comment}, 
    %
    stringstyle = \color{string}, 
    %
    stepnumber=1,
    numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
    backgroundcolor=\color{background},
    literate=
    % Keywords
        {th\_name}{{{\color{thname}th\_name}}}{7}
    % Math Symbols
        {â„•}{{\ensuremath{\mathbb{N}}}}{1}
        {â„¤}{{\ensuremath{\mathbb{Z}}}}{1}
        {â„}{{\ensuremath{\mathbb{R}}}}{1}
        {â„š}{{\ensuremath{\mathbb{Q}}}}{1}
        {â„‚}{{\ensuremath{\mathbb{C}}}}{1}
        {âˆ©}{{\ensuremath{\cap}}}{1}
        {âˆª}{{\ensuremath{\cup}}}{1}
        {âŠ‚}{{\ensuremath{\subseteq}}}{1}
        {âŠ†}{{\ensuremath{\subseteq}}}{1}
        {âŠ„}{{\ensuremath{\nsubseteq}}}{1}
        {âŠˆ}{{\ensuremath{\nsubseteq}}}{1}
        {âŠƒ}{{\ensuremath{\supseteq}}}{1}
        {âŠ‡}{{\ensuremath{\supseteq}}}{1}
        {âŠ…}{{\ensuremath{\nsupseteq}}}{1}
        {âŠ‰}{{\ensuremath{\nsupseteq}}}{1}
        {âˆˆ}{{\ensuremath{\in}}}{1}
        {âˆ‰}{{\ensuremath{\notin}}}{1}
        {âˆ‹}{{\ensuremath{\ni}}}{1}
        {âˆŒ}{{\ensuremath{\notni}}}{1}
        {âˆ…}{{\ensuremath{\emptyset}}}{1}
        {âˆ«}{{\ensuremath{\int}}}{1}
        {âˆ‘}{{\ensuremath{\mathrm{\Sigma}}}}{1}
        {Î }{{\ensuremath{\mathrm{\Pi}}}}{1}
        {â‰¤}{{\ensuremath{\leq}}}{1}
        {â‰¥}{{\ensuremath{\geq}}}{1}
        {â‰ }{{\ensuremath{\neq}}}{1}
        {â‰ˆ}{{\ensuremath{\approx}}}{1}
        {â‰¡}{{\ensuremath{\equiv}}}{1}
        {â‰ƒ}{{\ensuremath{\simeq}}}{1}
    % Greek Letters lowercase
        {Î±}{{\ensuremath{\mathrm{\alpha}}}}{1}
        {Î²}{{\ensuremath{\mathrm{\beta}}}}{1}
        {Î³}{{\ensuremath{\mathrm{\gamma}}}}{1}
        {Î´}{{\ensuremath{\mathrm{\delta}}}}{1}
        {Îµ}{{\ensuremath{\mathrm{\varepsilon}}}}{1}
        {Î¶}{{\ensuremath{\mathrm{\zeta}}}}{1}
        {Î·}{{\ensuremath{\mathrm{\eta}}}}{1}
        {Î¸}{{\ensuremath{\mathrm{\theta}}}}{1}
        {Î¹}{{\ensuremath{\mathrm{\iota}}}}{1}
        {Îº}{{\ensuremath{\mathrm{\kappa}}}}{1}
        {Î¼}{{\ensuremath{\mathrm{\mu}}}}{1}
        {Î½}{{\ensuremath{\mathrm{\nu}}}}{1}
        {Î¾}{{\ensuremath{\mathrm{\xi}}}}{1}
        {Ï€}{{\ensuremath{\mathrm{\mathnormal{\pi}}}}}{1}
        {Ï}{{\ensuremath{\mathrm{\rho}}}}{1}
        {Ïƒ}{{\ensuremath{\mathrm{\sigma}}}}{1}
        {Ï„}{{\ensuremath{\mathrm{\tau}}}}{1}
        {Ï†}{{\ensuremath{\mathrm{\varphi}}}}{1}
        {Ï‡}{{\ensuremath{\mathrm{\chi}}}}{1}
        {Ïˆ}{{\ensuremath{\mathrm{\psi}}}}{1}
        {Ï‰}{{\ensuremath{\mathrm{\omega}}}}{1}
    % Greek Letters UPPERCASE
        {Î“}{{\ensuremath{\mathrm{\Gamma}}}}{1}
        {Î”}{{\ensuremath{\mathrm{\Delta}}}}{1}
        {Î˜}{{\ensuremath{\mathrm{\Theta}}}}{1}
        {Î›}{{\ensuremath{\mathrm{\Lambda}}}}{1}
        {Î£}{{\ensuremath{\mathrm{\Sigma}}}}{1}
        {Î¦}{{\ensuremath{\mathrm{\Phi}}}}{1}
        {Î}{{\ensuremath{\mathrm{\Xi}}}}{1}
        {Î¨}{{\ensuremath{\mathrm{\Psi}}}}{1}
        {Î©}{{\ensuremath{\mathrm{\Omega}}}}{1}
    % Arrows
        {â†¦}{{\ensuremath{\mapsto}}}{1}
        {â†}{{\ensuremath{\leftarrow}}}{1}
        {<-}{{\ensuremath{\leftarrow}}}{1}
        {â†’}{{\ensuremath{\rightarrow}}}{1}
        {->}{{\ensuremath{\rightarrow}}}{1}
        {â†”}{{\ensuremath{\leftrightarrow}}}{1}
        {<->}{{\ensuremath{\leftrightarrow}}}{1}
        {â‡’}{{\ensuremath{\Rightarrow}}}{1}
        {âŸ¹}{{\ensuremath{\Longrightarrow}}}{1}
        {â‡}{{\ensuremath{\Leftarrow}}}{1}
        {âŸ¸}{{\ensuremath{\Longleftarrow}}}{1}
        {Î£}{{\ensuremath{\Sigma}}}{1}
        {Î }{{\ensuremath{\Pi}}}{1}
        {âˆ€}{{\ensuremath{\forall}}}{1}
        {âˆƒ}{{\ensuremath{\exists}}}{1}
        {Î»}{{\ensuremath{\mathrm{\lambda}}}}{1}
        {âˆ§}{{\ensuremath{\wedge}}}{1}
        {âˆ¨}{{\ensuremath{\vee}}}{1}
        {Â¬}{{\ensuremath{\neg}}}{1}
        {âŠ¢}{{\ensuremath{\vdash}}}{1}
        {â€–}{{\ensuremath{\|}}}{1}
    % subscripts
        {â‚}{{\ensuremath{_1}}}{1}
        {â‚‚}{{\ensuremath{_2}}}{1}
        {â‚ƒ}{{\ensuremath{_3}}}{1}
        {â‚„}{{\ensuremath{_4}}}{1}
        {â‚…}{{\ensuremath{_5}}}{1}
        {â‚†}{{\ensuremath{_6}}}{1}
        {â‚‡}{{\ensuremath{_7}}}{1}
        {â‚ˆ}{{\ensuremath{_8}}}{1}
        {â‚‰}{{\ensuremath{_9}}}{1}
        {â‚€}{{\ensuremath{_0}}}{1}
        {áµ¢}{{\ensuremath{_i}}}{1}
        {â±¼}{{\ensuremath{_j}}}{1}
        {â‚}{{\ensuremath{_a}}}{1}
        {â»Â¹}{{\ensuremath{^{-1}}}}{1}
        {Â¹}{{\ensuremath{^1}}}{1}
        {â‚™}{{\ensuremath{_n}}}{1}
        {â‚˜}{{\ensuremath{_m}}}{1}
        {â‚š}{{\ensuremath{_p}}}{1}
    % Others
        {â†‘}{{\ensuremath{\uparrow}}}{1}
        {â†“}{{\ensuremath{\downarrow}}}{1}
        {âŠ¢}{{\ensuremath{\vdash}}}{1}
        {|-}{{\ensuremath{\vdash}}}{1}
        {âŠ¥}{{\ensuremath{\perp}}}{1}
        {âˆ}{{\ensuremath{\infty}}}{1}
        {âˆ‚}{{\ensuremath{\partial}}}{1}
        {âˆš}{{\ensuremath{\sqrt}}}{1}
        {âˆ˜}{{\ensuremath{\circ}}}{1}
        {Ã—}{{\ensuremath{\times}}}{1}
        {âˆ†}{{\ensuremath{\triangle}}}{1}
        {âŸ¨}{{\ensuremath{\color{leanblue}\langle}}}{1}
        {âŸ©}{{\ensuremath{\color{leanblue}\rangle}}}{1}
        {â¦ƒ}{{\ensuremath{\color{leanblue}\{\!|}}}{1}
        {â¦„}{{\ensuremath{\color{leanblue}|\!\}}}}{1}
        {â„’}{{\ensuremath{\mathscr{L}}}}{1}
        {ğ’«}{{\ensuremath{\mathcal{P}}}}{1}
        {Â·}{{\ensuremath{\cdot}}}{1},
}

\lstdefinestyle{lean}{
    language=lean,
    numbers=none, 
    keywordstyle=\color{leanblue},
    keywordstyle=[2]\color{sorry},
    % frame=none,
    backgroundcolor=\color{white}, 
}